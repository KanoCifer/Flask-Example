{% extends 'base.html' %} {% block title %}Home{% endblock %} {% block content
%} {# --- Add Book Form (Only for logged-in users) --- #} {% if
current_user.is_authenticated %}
<div class="mb-6 rounded-xl bg-gray-50 p-6 shadow-xl dark:bg-gray-800">
  <p class="mb-4 text-2xl font-medium">Add a New Book to your ReadingList</p>
  <form method="post">
    {{ form.hidden_tag() }}
    <div class="form-group">
      {{ form.title.label(class="block text-sm font-medium text-gray-700
      dark:text-gray-300 mb-3") }} {{ form.title(class="form-control",
      autocomplete="off", placeholder=form.title.description) }} {% for error in
      form.title.errors %}
      <span class="error-message">{{ error }}</span>
      {% endfor %}
    </div>
    <div class="form-group">
      {{ form.author.label(class="block text-sm font-medium text-gray-700
      dark:text-gray-300 mb-3") }} {{ form.author(class="form-control",
      autocomplete="off", placeholder=form.author.description) }} {% for error
      in form.author.errors %}
      <span class="error-message">{{ error }}</span>
      {% endfor %}
    </div>
    {{ form.submit(class="btn-primary px-6 py-2 rounded-xl text-white
    font-semibold shadow-md", value="Add") }}
  </form>
</div>
{% endif %} {# --- User Books Section (Only if logged in) --- #} {% if
current_user.is_authenticated %}

<!-- ä¹¦ç±æ•°é‡ -->
<div
  class="my-4 flex items-center justify-between border-b border-gray-400 pb-2"
>
  <h2
    class="rounded-2xl border-2 border-blue-200 bg-blue-50 px-4 py-2 text-2xl font-bold text-gray-800 shadow-md dark:border-blue-500 dark:bg-blue-400"
  >
    My Books ({{ user_books|length }})
  </h2>
</div>

<div
  class="mb-8 overflow-hidden rounded-xl bg-white shadow-lg ring-1 ring-black/5 dark:bg-gray-800 dark:ring-white/10"
>
  {% if user_books %}
  <ul class="divide-y divide-gray-100 dark:divide-gray-700">
    {% for book in user_books %}
    <li
      class="group flex items-center justify-between p-4 transition-colors duration-200 hover:bg-gray-50 dark:hover:bg-gray-700/50"
    >
      <div class="min-w-0 flex-1 pr-4">
        <p
          class="text-md truncate font-medium text-gray-900 hover:underline dark:text-gray-100"
          title="{{ book.title }}"
        >
          ðŸ“– ã€Š{{ book.title }}ã€‹
        </p>
      </div>

      <div class="flex shrink-0 items-center gap-4">
        <div
          class="flex items-center gap-2 opacity-100 transition-opacity sm:opacity-0 sm:group-hover:opacity-100"
        >
          <a
            class="btn rounded-xl px-3 py-1 text-sm shadow-md transition-transform hover:scale-105"
            href="{{ url_for('main.edit', book_id=book.id) }}"
            >Edit</a
          >
          <form
            class="inline-flex"
            method="post"
            action="{{ url_for('main.delete', book_id=book.id) }}"
          >
            <input
              class="btn cursor-pointer rounded-xl px-3 py-1 text-sm shadow-md transition-transform hover:scale-105"
              type="submit"
              name="delete"
              value="Delete"
              onclick="return confirm('Are you sure?');"
            />
          </form>
          <a
            class="douban rounded-xl px-3 py-1 text-sm font-semibold text-white shadow-md transition-transform hover:scale-105"
            href="https://book.douban.com/subject_search?search_text={{ book.title }}"
            target="_blank"
            title="Find this book on douban"
            >è±†ç“£</a
          >
        </div>
        <span
          class="hidden text-sm font-medium text-gray-500 italic hover:underline sm:block dark:text-gray-400"
        >
          {{ book.author }}
        </span>
      </div>
    </li>
    {% endfor %}
  </ul>
  {% else %}
  <div class="p-6 text-center text-gray-500 italic dark:text-gray-400">
    No books added yet. Use the form above to add one!
  </div>
  {% endif %}
</div>
{% endif %} {# --- Owner Books Section (Always visible) --- #}

<!-- ä½œè€…ä¹¦ç±æ•°é‡ -->
<div
  class="my-4 flex items-center justify-between border-b border-gray-400 pb-2"
>
  <h2
    class="rounded-2xl border-2 border-green-200 bg-green-50 px-4 py-2 text-2xl font-bold text-gray-800 shadow-md dark:border-teal-700 dark:bg-teal-600"
  >
    Owner's Books ({{ owner_books|length }})
  </h2>
</div>

<div
  class="overflow-hidden rounded-xl bg-white shadow-lg ring-1 ring-black/5 dark:bg-gray-800 dark:ring-white/10"
>
  {% if owner_books %}
  <ul class="divide-y divide-gray-100 dark:divide-gray-700">
    {% for book in owner_books %}
    <li
      class="group flex items-center justify-between p-4 transition-colors duration-200 hover:bg-gray-50 dark:hover:bg-gray-700/50"
    >
      <div class="min-w-0 flex-1 pr-4">
        <p
          class="text-md truncate font-medium text-gray-900 hover:underline dark:text-gray-100"
          title="{{ book.title }}"
        >
          ðŸ“– ã€Š{{ book.title }}ã€‹
        </p>
      </div>

      <div class="flex shrink-0 items-center gap-4">
        <div
          class="flex items-center gap-2 opacity-100 transition-opacity sm:opacity-0 sm:group-hover:opacity-100"
        >
          <a
            class="douban rounded-xl px-3 py-1 text-sm font-semibold text-white shadow-md transition-transform hover:scale-105"
            href="https://book.douban.com/subject_search?search_text={{ book.title }}"
            target="_blank"
            title="Find this book on douban"
            >è±†ç“£</a
          >
        </div>
        <span
          class="hidden text-sm font-medium text-gray-500 italic hover:underline sm:block dark:text-gray-400"
        >
          {{ book.author }}
        </span>
      </div>
    </li>
    {% endfor %}
  </ul>
  {% else %}
  <div class="p-6 text-center text-gray-500 dark:text-gray-400">
    The owner hasn't added any books yet.
  </div>
  {% endif %}
</div>

<img
  class="cat mt-8"
  alt="Cute Cat"
  src="{{ url_for('static', filename='images/cat.gif') }}"
/>

{% endblock %}
